jQuery(document).ready(function(){member.init()});member=function(){return{phone_country:"",init:function(){member.addEvents(jQuery("body"));member.getLocationOptions(jQuery(".country_id-group select"))},addEvents:function(b){member.changePhoneFlag(b.find("#country_id"));var a=parseInt(b.find("#default_inviter").val());if(a){jQuery(".registration-button").show()}b.find("#captcha").val("");b.find("form").on("submit",function(){var c=jQuery("#phone");var d=c.intlTelInput("getSelectedCountryData");jQuery("#phone_iso").val(d.iso2);jQuery("#phone_code").val(d.dialCode);return member.validateForm(jQuery(this))});b.find("#password").on("input",function(){member.validatePasswordForm(jQuery("#password_again"))});b.find("#password_again").on("input",function(){member.validatePasswordForm(jQuery(this))});b.find("#email").on("input",function(){member.validateEmailForm(jQuery("#email_again"))});b.find("#email_again").on("input",function(){member.validateEmailForm(jQuery(this))});b.find("#country_id").on("change",function(){member.getLocationOptions(jQuery(this));member.changePhoneFlag(jQuery(this))});b.find(".search-inviter").on("click",function(){member.getMemberInviter(jQuery(this))});b.find(".registration-button").on("click",function(){jQuery(".select_inviter").hide();jQuery(".registration-button").show();jQuery(".account_detail").show();jQuery(".personal_detail").show()});b.find(".refresh-captcha").on("click",function(){member.changeCaptcha(jQuery(this))});b.find(".has_inviter input").on("ifChecked",function(){var c=parseInt(b.find(this).val());if(c){member.clearMemberInviter();b.find(".inviter-group").show()}else{member.getMemberInviter(jQuery(this));b.find(".inviter-group").hide()}});member.validateEmailForm(jQuery("#email_again"));keyword=jQuery(".inviter-group input#inviter").val();is_default=parseInt(jQuery("input#is_default").val());if(keyword!==""&&typeof keyword!==typeof undefined&&!is_default){member.getMemberInviter(jQuery(".inviter-group"),keyword)}return b},validatePasswordForm:function(a){if(a.val()!==jQuery("#password").val()){jQuery("#password_again").each(function(){this.setCustomValidity("Password Must be Matching.")})}else{jQuery("#password_again").each(function(){this.setCustomValidity("")})}},validateEmailForm:function(a){if(a.val()!==jQuery("#email").val()){jQuery("#email_again").each(function(){console.log("Email Must be Matching.");this.setCustomValidity("Email Must be Matching.")})}else{jQuery("#email_again").each(function(){this.setCustomValidity("")})}},validateForm:function(e){var j=false;var b=title="Registration Form Has Errors";var c=e.find(".inviter_id").val();var a=e.find(".name").val();var d=e.find(".username").val();var g=e.find(".email").val();var i=e.find(".password").val();var f=e.find(".password_again").val();var h=e.find(".id_passport").val();if(c===""){j=true;b+="<br>-<b>Inviter</b> Not Defined.<br>"}if(a===""){j=true;b+="-<b>Name</b> is a required Field. It can not be Empty.<br>"}if(d===""){j=true;b+="-<b>Username</b> is a required Field. It can not be Empty.<br>"}if(g===""){j=true;b+="-<b>Email</b> is a required Field. It can not be Empty.<br>"}if(i===""&&e.find(".password").length){j=true;b+="-<b>Password</b> is a required Field. It can not be Empty.<br>"}if(f===""&&e.find(".password_again").length){j=true;b+="-<b>Pasword Again</b> is a required Field. It can not be Empty.<br>"}if(h===""){j=true;b+="-<b>Id or Passport</b> is a required Field. It can not be Empty.<br>"}if(j){kazist.showDialog(title,b,"error");return false}else{return true}},clearMemberInviter:function(){jQuery(".inviter_detail-group .inviter_detail_name").html("");jQuery(".inviter-group .inviter_id").val("");jQuery(".inviter_detail-group").hide()},changeCaptcha:function(){var b=jQuery(".captcha-group .captcha-image").attr("src");var a=b+"?"+(new Date()).getTime();jQuery(".captcha-group .captcha-image-wrapper img").remove();jQuery(".captcha-image-wrapper").html('<img class="captcha-image" src="'+a+'">')},getMemberInviter:function(c,b){if(typeof b==="undefined"){b=c.closest(".inviter-group").find("input").val()}var d={keyword:b};var a=kazist.callAjax(kazist_document.web_base+"/social/members/ajaxinviter",d,true);if(typeof a.id!=="undefined"&&a!==null){inviter_id=a.id;inviter_html="<b>Name: </b>"+a.name+"("+a.username+")<br><b>Email: </b> "+a.email+"<br><b>Phone: </b> "+a.phone+"<br>";jQuery(".registration-buttons").show()}else{inviter_id="";inviter_html='<font color="red">Inviter Not Found.</font>'}jQuery(".inviter_detail-group .inviter_detail_name").html(inviter_html);jQuery(".inviter-group .inviter_id").val(inviter_id);jQuery(".inviter_detail-group").show()},phoneInputEvent:function(a){jQuery("#phone").intlTelInput("destroy");jQuery("#phone").intlTelInput({preferredCountries:["ke","us","gb"],initialCountry:a,autoPlaceholder:true,autoHideDialCode:false})},changePhoneFlag:function(b){var c=parseInt(b.val());if(c){var a=countries_codes[c].toLowerCase();member.phoneInputEvent(a)}else{member.phoneInputEvent("ke")}},getLocationOptions:function(c){var e=c.val();if(e){var a=countries_codes[e].toLowerCase()}else{a="ke"}var d={country_code:a,country_id:e,location_id:location_id};c.closest("form").find(".location_id-group").hide();var b=kazist.callAjax(kazist_document.web_base+"/setup/regions/ajaxloadregionoption",d,true);if(b!==""){c.closest("form").find(".location_id-group").show();c.closest("form").find("#location_id").html(b)}return false}}}();